"use strict";(self.webpackChunkfcb_site=self.webpackChunkfcb_site||[]).push([[969],{6969:function(e,n,t){t.r(n);var s=t(4165),c=t(5861),a=t(885),r=t(2791),i=t(4466),o=t(1313),l=t(8609),u=t(8023),d=t(8287),m=t(7674),p=t(7689),h=(t(4828),t(9816)),f=t(1665),v=t(184);n.default=function(){var e=(0,r.useContext)(f.V),n=(0,r.useState)(!1),t=(0,a.Z)(n,2),x=t[0],b=t[1],w=(0,r.useState)(!1),j=(0,a.Z)(w,2),k=j[0],g=j[1],_=(0,r.useState)(!1),N=(0,a.Z)(_,2),Z=N[0],y=N[1],C=(0,d.x)(),A=C.isLoading,I=(C.error,C.sendRequest),T=(C.clearError,(0,p.UO)()),E=(0,p.s0)(),S=(0,h.c)({comment:{value:"",isValid:!1}},!1),z=(0,a.Z)(S,2),O=z[0],B=z[1],D=function(){var n=(0,c.Z)((0,s.Z)().mark((function n(t){return(0,s.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return t.preventDefault(),n.prev=1,n.next=4,I("".concat("https://barcelona-website-29be533385b9.herokuapp.com/api","/comments/").concat(T.nid),"POST",JSON.stringify({comment:O.inputs.comment.value}),{"Content-Type":"application/json",Authorization:"Bearer "+e.token});case 4:n.sent,n.next=9;break;case 7:n.prev=7,n.t0=n.catch(1);case 9:V();case 10:case"end":return n.stop()}}),n,null,[[1,7]])})));return function(e){return n.apply(this,arguments)}}(),L=function(){var n=(0,c.Z)((0,s.Z)().mark((function n(t){var c;return(0,s.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return t.preventDefault(),n.prev=1,n.next=4,I("".concat("https://barcelona-website-29be533385b9.herokuapp.com/api","/news/likes/").concat(T.nid),"PATCH",JSON.stringify({}),{"Content-Type":"application/json",Authorization:"Bearer "+e.token});case 4:c=n.sent,y((function(e){return!e})),b(c.news),n.next=11;break;case 9:n.prev=9,n.t0=n.catch(1);case 11:case"end":return n.stop()}}),n,null,[[1,9]])})));return function(e){return n.apply(this,arguments)}}();(0,r.useEffect)((function(){var e=function(){var e=(0,c.Z)((0,s.Z)().mark((function e(){var n;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,I("".concat("https://barcelona-website-29be533385b9.herokuapp.com/api","/news/").concat(T.nid));case 3:n=e.sent,b(n.news),e.next=9;break;case 7:e.prev=7,e.t0=e.catch(0);case 9:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}();e(),V(),setTimeout((function(){window.scrollTo(0,0)}),250)}),[I]);var V=function(){var e=(0,c.Z)((0,s.Z)().mark((function e(){var n;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,I("".concat("https://barcelona-website-29be533385b9.herokuapp.com/api","/comments/").concat(T.nid));case 3:n=e.sent,g(n.comments),e.next=9;break;case 7:e.prev=7,e.t0=e.catch(0);case 9:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}();(0,r.useEffect)((function(){if(e.userId&&x.likes){var n=x.likes.find((function(n){return n===e.userId}));console.log(!!n),y(!!n)}else y(!1)}),[e.userId,x.likes]);var J=function(){var n=(0,c.Z)((0,s.Z)().mark((function n(t){return(0,s.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,I("".concat("https://barcelona-website-29be533385b9.herokuapp.com/api","/comments/").concat(t.target.id),"DELETE",null,{Authorization:"Bearer "+e.token});case 3:n.sent,n.next=8;break;case 6:n.prev=6,n.t0=n.catch(0);case 8:V();case 9:case"end":return n.stop()}}),n,null,[[0,6]])})));return function(e){return n.apply(this,arguments)}}(),P=k&&k.map((function(n,t){return(0,v.jsxs)("div",{className:"comment ".concat(parseInt(t)%2&&"even"),children:[(0,v.jsx)("span",{className:"fas fa-times ".concat(n.author.id===e.userId&&"visible"),id:n.id,onClick:J}),(0,v.jsx)("div",{className:"comment-author",children:(0,v.jsx)("b",{children:n.author.nickname})}),(0,v.jsx)("div",{className:"comment-content",children:n.comment})]},n.id)})),Y=x&&x.article.map((function(e,n){return(0,v.jsxs)("div",{className:"news-single__article",children:[(0,v.jsx)("div",{className:"news-single__article-title",children:(0,v.jsx)("h3",{children:e.title})}),(0,v.jsx)("div",{className:"news-single__article-description",children:e.description})]},n)}));return(0,v.jsxs)("div",{className:"news-single",children:[A&&(0,v.jsx)("div",{className:"center",children:(0,v.jsx)(m.Z,{asOverlay:!0})}),!A&&x&&(0,v.jsx)(i.Z,{children:x&&(0,v.jsxs)("div",{className:"news-single__container",children:[(0,v.jsx)("div",{className:"news-single__image",children:(0,v.jsx)("img",{src:"".concat("https://barcelona-website.s3.eu-central-1.amazonaws.com","/").concat(x.image),alt:x.name})}),(0,v.jsxs)("div",{className:"news-single__info",children:[(0,v.jsx)("div",{className:"news-single__info-title",children:(0,v.jsx)("h2",{children:x.title})}),Y,(0,v.jsxs)("div",{className:"news-single__info-bottom",children:[(0,v.jsx)("div",{className:"news-single__info-bottom-date",children:x.createdAt.slice(0,10)}),(0,v.jsxs)("div",{className:"news-single__info-bottom-author",children:["Author: ",(0,v.jsx)("b",{children:x.author.nickname})]}),(0,v.jsxs)("div",{className:"news-single__info-bottom-likes",children:[(0,v.jsx)("span",{onClick:L,className:"fas fa-thumbs-up"})," ",x.likes.length,Z&&(0,v.jsx)("div",{children:"You like it!"})]})]})]}),(0,v.jsxs)("div",{className:"news-single__comments",children:[(0,v.jsx)("div",{className:"back",children:(0,v.jsx)(o.Z,{onClick:function(){E(-1)},children:"Back to list"})}),e.isLoggedIn&&(0,v.jsxs)("div",{style:{margin:"50px auto"},children:[(0,v.jsx)(l.Z,{id:"comment",element:"textarea",label:"Your Comment",validators:[(0,u.hg)()],onInput:B}),(0,v.jsx)(o.Z,{size:"small",inverse:!0,disabled:!O.isValid,onClick:D,children:"Add Comment"})]}),(0,v.jsx)("h4",{children:"Comments"}),P.length>0?(0,v.jsx)("div",{className:"news-single__comments-container",children:P}):(0,v.jsx)("span",{style:{display:"block",textAlign:"center"},children:"no comments yet"})]})]})})]})}},4466:function(e,n,t){t(2791);var s=t(184);n.Z=function(e){return(0,s.jsx)("div",{className:"card ".concat(e.className),style:e.style,children:e.children})}}}]);
//# sourceMappingURL=969.21db3e38.chunk.js.map